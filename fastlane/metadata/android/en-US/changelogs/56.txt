Major bug fixes and UI improvements.